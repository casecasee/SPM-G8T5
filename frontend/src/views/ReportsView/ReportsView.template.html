<div class="tasks-page">
  <div class="tasks-header">
    <h2>Reports</h2>
    <div class="header-buttons">


    </div>
  </div>

  <!-- Tabs visible to all users -->
  <div class="tabs">
    <button :class="['tab', currentTab==='individual_report' ? 'active' : '']"
      @click ="currentTab='individual_report'">My Task Report</button>
    <button :class="['tab', currentTab==='project_report' ? 'active' : '']"
      @click ="currentTab==='project_report'">Project Report</button>
    
    <button :class="['tab', currentTab==='dept_report' ? 'active' : '']" @click="currentTab='dept_report'">Department
      Report</button>
    <button :class="['tab', currentTab==='company_report' ? 'active' : '']" @click="currentTab='company_report'"
      v-if="isSeniorManagerOrHR">Company Report</button>

  </div>

  <!--individual report-->
  <div v-if="currentTab==='individual_report'" class="report-tab">
    <div class="report-controls">
      <div class="left-controls">
        <label for="start-date">Start:</label>
        <input type="date" v-model="startDate" id="start-date" @change="filterTasksByDate" />
        <label for="end-date">End:</label>
        <input type="date" v-model="endDate" id="end-date" @change="filterTasksByDate" />
        <button class="filter-btn" @click="filterTasksByDate">Filter by Date</button>
      </div>
      <div class="right-controls">
        <button class="download-btn" @click="printReport">Download Report</button>
      </div>
    </div>

    <div class="report-card">
      <h2 class="report-title">üìä Task Report</h2>
      <div class="report-summary">
        <h3>Task Summary ({{formattedDateRange}})</h3>
        <ul>
          <li><strong>Overall Progress:</strong> {{ report_overallProgress }}</li>
          <li><strong>Total Tasks:</strong> {{ report_displayTasks.length }}</li>
          <li><strong>Overdue Tasks:</strong> {{ report_overdueTasks.length }}</li>
          <li><strong>High Priority:</strong> {{ report_tasksByPriority.high.length }}</li>
          <li><strong>Medium Priority:</strong> {{ report_tasksByPriority.medium.length }}</li>
          <li><strong>Low Priority:</strong> {{ report_tasksByPriority.low.length }}</li>
          <li>
            <strong>Completed Tasks:</strong>
            {{
            report_displayTasks.filter(
            t => t.status?.toLowerCase() === 'done' || t.status?.toLowerCase() === 'completed'
            ).length
            }}
          </li>
        </ul>


      </div>

      <!-- High Priority -->
      <div class="task-section">
        <div class="section-header report-high-priority-header">
          <span>High Priority</span>
          <span class="task-count">{{ report_tasksByPriority.high.length }}</span>
        </div>

        <div class="task-details">
          <div v-if="hasTasksInSection('high')" class="priority-section">
            <div class="tasks-grid">
              <Card v-for="task in report_tasksByPriority.high" :key="task.id" class="task-card"
                :class="{'task-overdue': isOverdue(task)}" @click="openDetails(task) ">
                <template #title>
                  <p v-if="isOverdue(task)" class="report-overdue-label">‚ö†Ô∏è Overdue</p>
                  <div class="task-title-row">
                    <span>{{ task.name }}</span>
                  </div>
                  <p class="desc" style="font-weight: normal;">{{ task.description }}</p>
                </template>

                <template #content>
                  <div class="task-body">
                    <div class="task-info">
                      <div class="info-item">
                        <i class="pi pi-calendar-plus"></i>
                        <strong>Start:</strong> {{ formatDate(task.created_at) }}
                      </div>

                      <div class="info-item">
                        <i class="pi pi-calendar-times"></i>
                        <strong>Due:</strong> {{ formatDate(task.due_date) }}
                        <span class="relative-time">({{ formatDateRelative(task.due_date) }})</span>
                      </div>

                      <div class="info-item">
                        <i class="pi pi-bolt"></i>
                        <strong>Priority Score:</strong>
                        <span class="priority-tag">
                          {{ task.priority || 'N/A' }}
                        </span>
                      </div>

                      <div class="info-item">
                        <i class="pi pi-check-circle"></i>
                        <strong>Status:</strong>
                        <span class="status-pill" :class="getStatusClass(task.status)">
                          {{ task.status }}
                        </span>
                      </div>

                      <div class="info-item">
                        <i class="pi pi-user"></i>
                        <strong>Owner:</strong> {{ getOwnerName(task.owner) || currentEmployeeName }}
                      </div>

                      <div class="info-item">
                        <i class="pi pi-users"></i>
                        <strong>Collaborators:</strong> {{ getCollaboratorNames(task.collaborators) || 'None' }}
                      </div>
                    </div>
                  </div>
                </template>

              </Card>
            </div>
          </div>
          <p v-else class="no-tasks-message">No high priority tasks in this timeframe</p>
        </div>
      </div>

      <!--Medium Priority-->
      <div class="task-section">
        <div class="section-header report-medium-priority-header">
          <span>Medium Priority</span>
          <span class="task-count">{{ report_tasksByPriority.medium.length }}</span>
        </div>
        <div class="task-details">
          <!-- <div class="section-header ongoing">Ongoing</div> -->
          <div v-if="hasTasksInSection('medium')" class="priority-section">

            <div class="tasks-grid">
              <Card v-for="task in report_tasksByPriority.medium" :key="task.id" class="task-card"
                :class="{'task-overdue': isOverdue(task)}" @click="openDetails(task)">

                <template #title>
                  <p v-if="isOverdue(task)" class="report-overdue-label">‚ö†Ô∏è Overdue</p>
                  <div class="task-title-row">
                    <span>{{ task.name }}</span>

                  </div>
                  <p class="desc" style="font-weight: normal;">{{ task.description }}</p>
                </template>

                <template #content>
                  <div class="task-body">
                    <div class="task-info">
                      <div class="info-item">
                        <i class="pi pi-calendar-plus"></i>
                        <strong>Start:</strong> {{ formatDate(task.created_at) }}
                      </div>

                      <div class="info-item">
                        <i class="pi pi-calendar-times"></i>
                        <strong>Due:</strong> {{ formatDate(task.due_date) }}
                        <span class="relative-time">({{ formatDateRelative(task.due_date) }})</span>
                      </div>

                      <div class="info-item">
                        <i class="pi pi-bolt"></i>
                        <strong>Priority Score:</strong>
                        <span class="priority-tag">
                          {{ task.priority || 'N/A' }}
                        </span>
                      </div>

                      <div class="info-item">
                        <i class="pi pi-check-circle"></i>
                        <strong>Status:</strong>
                        <span class="status-pill" :class="getStatusClass(task.status)">
                          {{ task.status }}
                        </span>
                      </div>

                      <div class="info-item">
                        <i class="pi pi-user"></i>
                        <strong>Owner:</strong> {{ getOwnerName(task.owner) || currentEmployeeName }}
                      </div>

                      <div class="info-item">
                        <i class="pi pi-users"></i>
                        <strong>Collaborators:</strong> {{ getCollaboratorNames(task.collaborators) || 'None' }}
                      </div>
                    </div>
                  </div>
                </template>
              </Card>
            </div>
          </div>
          <p v-else class="no-tasks-message">No medium priority tasks in this timeframe</p>
        </div>
      </div>

      <!-- Low Priority -->
      <div class="task-section">
        <div class="section-header report-low-priority-header">
          <span>Low Priority</span>
          <span class="task-count">{{ report_tasksByPriority.low.length }}</span>
        </div>
        <div class="task-details">

          <div v-if="hasTasksInSection('low')" class="priority-section">
            <div class="tasks-grid">
              <Card v-for="task in report_tasksByPriority.low" :key="task.id" class="task-card"
                :class="{ 'task-overdue': isOverdue(task) }" @click="openDetails(task)">
                <template #title>
                  <p v-if="isOverdue(task)" class="report-overdue-label">‚ö†Ô∏è Overdue</p>
                  <div class="task-title-row">
                    <span>{{ task.name }}</span>
                  </div>
                  <p class="desc" style="font-weight: normal;">{{ task.description }}</p>
                </template>

                <template #content>
                  <div class="task-body">
                    <div class="task-info">
                      <div class="info-item">
                        <i class="pi pi-calendar-plus"></i>
                        <strong>Start:</strong> {{ formatDate(task.created_at) }}
                      </div>

                      <div class="info-item">
                        <i class="pi pi-calendar-times"></i>
                        <strong>Due:</strong> {{ formatDate(task.due_date) }}
                        <span class="relative-time">({{ formatDateRelative(task.due_date) }})</span>
                      </div>

                      <div class="info-item">
                        <i class="pi pi-bolt"></i>
                        <strong>Priority Score:</strong>
                        <span class="priority-tag">
                          {{ task.priority || 'N/A' }}
                        </span>
                      </div>

                      <div class="info-item">
                        <i class="pi pi-check-circle"></i>
                        <strong>Status:</strong>
                        <span class="status-pill" :class="getStatusClass(task.status)">
                          {{ task.status }}
                        </span>
                      </div>

                      <div class="info-item">
                        <i class="pi pi-user"></i>
                        <strong>Owner:</strong> {{ getOwnerName(task.owner) || currentEmployeeName }}
                      </div>

                      <div class="info-item">
                        <i class="pi pi-users"></i>
                        <strong>Collaborators:</strong> {{ getCollaboratorNames(task.collaborators) || 'None' }}
                      </div>
                    </div>
                  </div>
                </template>
              </Card>
            </div>
          </div>
          <p v-else class="no-tasks-message">No low priority tasks in this timeframe</p>
        </div>
      </div>
    </div>
  </div>




  <!-- ================== Department Report ================== -->
  <div v-if="currentTab==='dept_report'" class="report-tab">
    <div class="report-controls">
      <div class="left-controls">
        <button class="filter-btn" @click="toggleDeptFilterMenu">Filter By</button>

        <div v-if="showDeptFilterMenu" class="filter-menu" @click.stop>
          Filter by Employee
          <div class="filter-section">
            <label>
              <input type="checkbox" v-model="deptFilterByEmployee" /> Filter by Employee
            </label>

            <div v-if="deptFilterByEmployee" class="employee-checkbox-list">
              <label v-for="emp in departmentEmployees" :key="emp.employee_id">
                <input type="checkbox" :value="emp.employee_id" v-model="deptSelectedEmployeeIds" />
                {{ emp.employee_name }}
              </label>
            </div>
          </div>



          <div class="filter-section">
            <label>
              <input type="checkbox" v-model="deptFilterByTask" /> Filter by Task
            </label>
          </div>


          <div class="filter-section">
            <label for="start-date-dept">Start:</label>
            <input type="date" v-model="deptStartDate" id="start-date-dept" />
            <label for="end-date-dept">End:</label>
            <input type="date" v-model="deptEndDate" id="end-date-dept" />
          </div>


          <div class="filter-buttons">
            <button class="save-task-btn" @click="applyDeptFilters">Done</button>
            <button class="cancel-subtask-btn" @click="toggleDeptFilterMenu">
              Cancel
            </button>
          </div>
        </div>
      </div>

      <div class="right-controls">
        <button class="download-btn" @click="printReport">Download Report</button>
      </div>
    </div>

    <div class="report-card">
      <!-- === CASE 1: FILTER BY EMPLOYEE(S) === -->
      <template v-if="deptFilterByEmployee && dept_employeeReports.length">
        <div v-for="empReport in dept_employeeReports" :key="empReport.employee.employee_id" class="employee-report">
          <h2 class="report-title">
            üë§ {{ empReport.employee.employee_name }}'s Task Report
          </h2>

          <div class="report-summary">
            <h3>Summary ({{ formattedDeptDateRange }})</h3>
            <ul>
              <li><strong>Department:</strong> {{ dept_overallProgress }}</li>
              <li><strong>Total Tasks:</strong> {{ empReport.tasks.length }}</li>
              <li>
                <strong>Overdue Tasks:</strong>
                {{ empReport.tasks.filter(t => isOverdue(t)).length }}
              </li>
              <li>
                <strong>High Priority:</strong>
                {{ groupTasksByPriority(empReport.tasks).high.length }}
              </li>
              <li>
                <strong>Medium Priority:</strong>
                {{ groupTasksByPriority(empReport.tasks).medium.length }}
              </li>
              <li>
                <strong>Low Priority:</strong>
                {{ groupTasksByPriority(empReport.tasks).low.length }}
              </li>
            </ul>
          </div>

          <!-- PRIORITY SECTIONS -->
          <div v-for="(tasks, label) in groupTasksByPriority(empReport.tasks)" :key="label" class="task-section">
            <div class="section-header" :class="{
               'report-high-priority-header': label === 'high',
               'report-medium-priority-header': label === 'medium',
               'report-low-priority-header': label === 'low'
             }">
              <span>{{ label.charAt(0).toUpperCase() + label.slice(1) }} Priority</span>
              <span class="task-count">{{ tasks.length }}</span>
            </div>

            <div class="task-details">
              <div v-if="tasks.length" class="priority-section">
                <Card v-for="task in tasks" :key="task.id" class="task-card horizontal-task"
                  :class="{ 'task-overdue': isOverdue(task) }" @click="openDetails(task)">
                  <template #title>
                    <p v-if="isOverdue(task)" class="report-overdue-label">‚ö†Ô∏è Overdue</p>
                    <div class="task-title-row">
                      <span>{{ task.name }}</span>
                    </div>
                    <p class="desc" style="font-weight: normal;">{{ task.description }}</p>
                  </template>

                  <template #content>
                    <div class="task-body horizontal-layout">
                      <div class="task-info">
                        <div class="info-item">
                          <i class="pi pi-calendar-plus"></i>
                          <strong>Start:</strong> {{ formatDate(task.created_at) }}
                        </div>

                        <div class="info-item">
                          <i class="pi pi-calendar-times"></i>
                          <strong>Due:</strong> {{ formatDate(task.due_date) }}
                          <span class="relative-time">
                            ({{ formatDateRelative(task.due_date) }})
                          </span>
                        </div>

                        <div class="info-item">
                          <i class="pi pi-bolt"></i>
                          <strong>Priority Score:</strong>
                          {{ task.priority || 'N/A' }}
                        </div>

                        <div class="info-item">
                          <i class="pi pi-check-circle"></i>
                          <strong>Status:</strong>
                          <span class="status-pill" :class="getStatusClass(task.status)">
                            {{ task.status }}
                          </span>
                        </div>

                        <div class="info-item">
                          <i class="pi pi-user"></i>
                          <strong>Owner:</strong>
                          {{ getOwnerName(task.owner) || empReport.employee.employee_name }}
                        </div>

                        <div class="info-item">
                          <i class="pi pi-users"></i>
                          <strong>Collaborators:</strong>
                          {{ getCollaboratorNames(task.collaborators) || 'None' }}
                        </div>
                      </div>
                    </div>
                  </template>
                </Card>
              </div>
              <p v-else class="no-tasks-message">No {{ label }} priority tasks</p>
            </div>
          </div>
          <hr class="employee-divider" />
        </div>
      </template>

      <!-- === CASE 2: DEFAULT DEPARTMENT REPORT === -->
      <template v-else>
        <h2 class="report-title">üè¢ Department Report</h2>

        <div class="report-summary">
          <h3>Summary ({{ formattedDeptDateRange }})</h3>
          <ul>
            <li><strong>Department:</strong> {{ dept_overallProgress }}</li>
            <li><strong>Total Tasks:</strong> {{ dept_displayTasks.length }}</li>
            <li><strong>Overdue Tasks:</strong> {{ dept_overdueTasks.length }}</li>
            <li><strong>High Priority:</strong> {{ dept_tasksByPriority.high.length }}</li>
            <li><strong>Medium Priority:</strong> {{ dept_tasksByPriority.medium.length }}</li>
            <li><strong>Low Priority:</strong> {{ dept_tasksByPriority.low.length }}</li>
          </ul>
        </div>

        <!-- Same task sections as before -->
        <div v-for="(tasks, label) in dept_tasksByPriority" :key="label" class="task-section">
          <div class="section-header" :class="{
             'report-high-priority-header': label === 'high',
             'report-medium-priority-header': label === 'medium',
             'report-low-priority-header': label === 'low'
           }">
            <span>{{ label.charAt(0).toUpperCase() + label.slice(1) }} Priority</span>
            <span class="task-count">{{ tasks.length }}</span>
          </div>

          <div class="task-details">
            <div v-if="tasks.length" class="priority-section">
              <Card v-for="task in tasks" :key="task.id" class="task-card horizontal-task"
                :class="{ 'task-overdue': isOverdue(task) }" @click="openDetails(task)">
                <template #title>
                  <p v-if="isOverdue(task)" class="report-overdue-label">‚ö†Ô∏è Overdue</p>
                  <div class="task-title-row">
                    <span>{{ task.name }}</span>
                  </div>
                  <p class="desc" style="font-weight: normal;">{{ task.description }}</p>
                </template>

                <template #content>
                  <div class="task-body horizontal-layout">
                    <div class="task-info">
                      <div class="info-item">
                        <i class="pi pi-calendar-plus"></i>
                        <strong>Start:</strong> {{ formatDate(task.created_at) }}
                      </div>

                      <div class="info-item">
                        <i class="pi pi-calendar-times"></i>
                        <strong>Due:</strong> {{ formatDate(task.due_date) }}
                        <span class="relative-time">
                          ({{ formatDateRelative(task.due_date) }})
                        </span>
                      </div>

                      <div class="info-item">
                        <i class="pi pi-bolt"></i>
                        <strong>Priority Score:</strong>
                        {{ task.priority || 'N/A' }}
                      </div>

                      <div class="info-item">
                        <i class="pi pi-check-circle"></i>
                        <strong>Status:</strong>
                        <span class="status-pill" :class="getStatusClass(task.status)">
                          {{ task.status }}
                        </span>
                      </div>

                      <div class="info-item">
                        <i class="pi pi-user"></i>
                        <strong>Owner:</strong> {{ getOwnerName(task.owner) }}
                      </div>

                      <div class="info-item">
                        <i class="pi pi-users"></i>
                        <strong>Collaborators:</strong> {{ getCollaboratorNames(task.collaborators) || 'None' }}
                      </div>
                    </div>
                  </div>
                </template>
              </Card>
            </div>
            <p v-else class="no-tasks-message">No {{ label }} priority tasks</p>
          </div>
        </div>
      </template>
    </div>

  </div>


  <!-- ================== Company Report (HR Only) ================== -->
  <div v-if="currentTab==='company_report'" class="report-tab">
    <div class="report-controls">
      <div class="left-controls">
        <label for="company-start">Start:</label>
        <input type="date" v-model="companyStartDate" id="company-start" />
        <label for="company-end">End:</label>
        <input type="date" v-model="companyEndDate" id="company-end" />

        <label for="dept-filter">Department:</label>
        <select v-model="companySelectedDept" id="dept-filter">
          <option value="">All Departments</option>
          <option  v-for="(deptData, deptName) in companyFilteredData" :key="deptName" :value="deptName">
            {{ deptName }}
          </option>
        </select>

        <button class="filter-btn" @click="applyCompanyFilters">Apply Filter</button>
      </div>

      <div class="right-controls">
        <button class="download-btn" @click="exportCompanyReport('pdf')">Download PDF</button>
      </div>
    </div>

    <div class="report-card">
      <h2 class="report-title">üè¢ Organisation-wide Productivity Report</h2>

      <div class="report-summary">
        <h3>Summary ({{ formattedCompanyDateRange }})</h3>
        <ul>
          <li><strong>Total Departments:</strong> {{ companyDepartmentCount }}</li>
          <li><strong>Total Tasks:</strong> {{ companyAllTasks.length }}</li>
          <li><strong>Completed Tasks:</strong> {{ companyCompletedTasks.length }}</li>
          <li><strong>Overdue Tasks:</strong> {{ companyOverdueTasks.length }}</li>
          <li><strong>Completion Rate:</strong> {{ companyCompletionRate }}%</li>
          <li><strong>Most Productive Department:</strong> {{ topProductiveDept || '‚Äî' }}</li>
          <li><strong>Most Overloaded Department:</strong> {{ overloadedDept || '‚Äî' }}</li>
        </ul>
      </div>

      <!-- Department Breakdown -->
<div
  v-for="(deptData, deptName) in companyFilteredData"
  :key="deptName"
  class="department-report"
>
  <h3 class="department-header">{{ deptName }} Department</h3>

  <ul class="department-metrics">
    <li>Total Tasks: {{ deptData.tasks.length }}</li>
    <li>Completed: {{ deptData.completed }}</li>
    <li>Overdue: {{ deptData.overdue }}</li>
    <li>On Time: {{ deptData.ontime }}</li>
  </ul>

  <div class="task-summary-bar">
    <div class="bar completed" :style="{ width: deptData.completionRate + '%' }">
      {{ deptData.completionRate }}% Completed
    </div>
  </div>

  <!-- ‚úÖ Detailed per-employee breakdown when filtering a department -->
  <div v-if="companySelectedDept">
    <div
      v-for="(teamObj, teamName) in companyTasksData[deptName]"
      :key="teamName"
      class="team-section"
    >
      <h4 class="team-header">{{ teamName }} Team</h4>

      <div
        v-for="(tasks, employeeName) in teamObj"
        :key="employeeName"
        class="employee-report"
      >
        <h5 class="employee-header">üë§ {{ employeeName }}‚Äôs Task Report</h5>

        <div
          v-for="(groupedTasks, label) in groupTasksByPriority(tasks)"
          :key="label"
          class="task-section"
        >
          <div class="section-header"
               :class="{
                 'report-high-priority-header': label === 'high',
                 'report-medium-priority-header': label === 'medium',
                 'report-low-priority-header': label === 'low'
               }">
            <span>{{ label.charAt(0).toUpperCase() + label.slice(1) }} Priority</span>
            <span class="task-count">{{ groupedTasks.length }}</span>
          </div>

          <div class="task-details">
            <div v-if="groupedTasks.length" class="priority-section">
              <Card
                v-for="task in groupedTasks"
                :key="task.id"
                class="task-card horizontal-task"
                :class="{ 'task-overdue': isOverdue(task) }"
                @click="openDetails(task)"
              >
                <template #title>
                  <p v-if="isOverdue(task)" class="report-overdue-label">‚ö†Ô∏è Overdue</p>
                  <div class="task-title-row">
                    <span>{{ task.name }}</span>
                  </div>
                  <p class="desc">{{ task.description }}</p>
                </template>

                <template #content>
                  <div class="task-body horizontal-layout">
                    <div class="info-item">
                      <i class="pi pi-calendar-plus"></i>
                      <strong>Start:</strong> {{ formatDate(task.created_at) }}
                    </div>
                    <div class="info-item">
                      <i class="pi pi-calendar-times"></i>
                      <strong>Due:</strong> {{ formatDate(task.due_date) }}
                      <span class="relative-time">
                        ({{ formatDateRelative(task.due_date) }})
                      </span>
                    </div>
                    <div class="info-item">
                      <i class="pi pi-bolt"></i>
                      <strong>Priority Score:</strong> {{ task.priority || 'N/A' }}
                    </div>
                    <div class="info-item">
                      <i class="pi pi-check-circle"></i>
                      <strong>Status:</strong>
                      <span class="status-pill" :class="getStatusClass(task.status)">
                        {{ task.status }}
                      </span>
                    </div>
                    <div class="info-item">
                      <i class="pi pi-user"></i>
                      <strong>Owner:</strong> {{ getOwnerName(task.owner) || employeeName }}
                    </div>
                    <div class="info-item">
                      <i class="pi pi-users"></i>
                      <strong>Collaborators:</strong> {{ getCollaboratorNames(task.collaborators) || 'None' }}
                    </div>
                  </div>
                </template>
              </Card>
            </div>
            <p v-else class="no-tasks-message">No {{ label }} priority tasks</p>
          </div>
        </div>
         <hr class="employee-divider" />
      </div>
    </div>
  </div>
</div>

    </div>
  </div>


<!-- ===========================
  PROJECT REPORT (Staff)
=========================== -->
<div v-if="currentTab === 'project_report'" class="report-tab">

  <div class="report-controls">
    <div class="left-controls">
      <button class="filter-btn" @click="toggleProjectFilterMenu">Filter By</button>

      <div v-if="showProjectFilterMenu" class="filter-menu" @click.stop>
        <div class="filter-section">
          <label>
            <input type="radio" value="" v-model="projectReportSelectedId" @change="selectProjectForReport(null)" />
            All Projects
          </label>

          <label v-for="proj in projectReportProjects" :key="proj.id">
            <input
              type="radio"
              :value="proj.id"
              v-model="projectReportSelectedId"
              @change="selectProjectForReport(proj.id)"
            />
            {{ proj.name }} ( #{{ proj.id }} )
          </label>
        </div>
      </div>
    </div>

    <div class="right-controls">
      <button class="download-btn" @click="exportProjectReportPDF" :disabled="projectReportGenerating">
        <i class="pi pi-file-pdf"></i> Download Report
      </button>
    </div>
  </div>

  <div class="report-card">
    <h2 class="report-title">üìÅ Project Schedule Report</h2>

    <div v-if="projectReportError" class="error-message">{{ projectReportError }}</div>

    <div v-if="projectReportSelectedId && projectReportDisplayTasks.length">
      <div class="report-summary">
        <h3>{{ projectReportSelected ? projectReportSelected.name : 'Selected Project' }}</h3>
        <ul>
          <li><strong>Overall Progress:</strong> {{ projectReportProgress }}% ({{ projectReportProgressLabel }})</li>
          <li><strong>Total Tasks:</strong> {{ projectReportTotalTasks }}</li>
          <li><strong>Completed Tasks:</strong> {{ projectReportCompletedTasks.length }}</li>
        </ul>
      </div>

      <table class="report-table">
        <thead>
          <tr>
            <th>Task Name</th>
            <th>Start</th>
            <th>Due</th>
            <th>Status</th>
            <th>Collaborators</th>
          </tr>
        </thead>
        <tbody>
          <tr v-for="task in projectReportDisplayTasks" :key="task.id">
            <td>{{ task.name }}</td>
            <td>{{ projectReportFormatDate(task.created_at) }}</td>
            <td>{{ projectReportFormatDate(task.due_date) }}</td>
            <td>{{ task.status }}</td>
            <td>{{ projectReportGetCollaboratorNames(task.collaborators) }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div v-else class="no-report">
      <p v-if="projectReportLoading">Loading project report...</p>
      <p v-else>Select a project to view the schedule report (use Filter By).</p>
    </div>
  </div>

</div>





</div>